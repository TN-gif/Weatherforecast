# æ‹¼å›¾æ¸¸æˆéŸ³é¢‘ç³»ç»Ÿå®Œæ•´å®ç°æ–‡æ¡£

**é¡¹ç›®åç§°**: æ‹¼å›¾æ¸¸æˆ (Puzzle)  
**å®æ–½æ—¶é—´**: 2025å¹´11æœˆ8æ—¥  
**æŠ€æœ¯æ ˆ**: HarmonyOS, ArkTS, AVPlayer  
**æ–‡æ¡£ç‰ˆæœ¬**: v1.0

---

## ğŸ“‘ ç›®å½•

1. [é¡¹ç›®æ¦‚è¿°](#é¡¹ç›®æ¦‚è¿°)
2. [éœ€æ±‚åˆ†æ](#éœ€æ±‚åˆ†æ)
3. [æŠ€æœ¯æ–¹æ¡ˆ](#æŠ€æœ¯æ–¹æ¡ˆ)
4. [å®æ–½æ­¥éª¤](#å®æ–½æ­¥éª¤)
5. [é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ](#é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ)
6. [æ ¸å¿ƒä»£ç ](#æ ¸å¿ƒä»£ç )
7. [æµ‹è¯•æŒ‡å—](#æµ‹è¯•æŒ‡å—)
8. [æ€»ç»“](#æ€»ç»“)

---

## é¡¹ç›®æ¦‚è¿°

æœ¬æ–‡æ¡£è®°å½•äº†ä¸ºæ‹¼å›¾æ¸¸æˆåº”ç”¨å®ç°å®Œæ•´éŸ³é¢‘ç³»ç»Ÿçš„å…¨è¿‡ç¨‹ï¼ŒåŒ…æ‹¬èƒŒæ™¯éŸ³ä¹æ’­æ”¾ã€å£°éŸ³æ§åˆ¶æŒ‰é’®ã€éŸ³é‡æŒä¹…åŒ–ã€æ’­æ”¾è¿›åº¦è®°å¿†ç­‰åŠŸèƒ½ã€‚

### å®ç°çš„æ ¸å¿ƒåŠŸèƒ½

âœ… **èƒŒæ™¯éŸ³ä¹ç³»ç»Ÿ**
- æ”¯æŒå¤šä¸ªéŸ³ä¹æ–‡ä»¶ï¼Œæ ¹æ®é¡µé¢å’Œé€‰æ‹©è‡ªåŠ¨åˆ‡æ¢
- å¾ªç¯æ’­æ”¾ï¼Œæ”¯æŒæ— ç¼åˆ‡æ¢
- åº”ç”¨ç”Ÿå‘½å‘¨æœŸç®¡ç†ï¼ˆå‰åå°åˆ‡æ¢ï¼‰

âœ… **å£°éŸ³æ§åˆ¶**
- ç»Ÿä¸€çš„å£°éŸ³å¼€å…³æŒ‰é’®ï¼ˆæ‰€æœ‰é¡µé¢å³ä¸Šè§’ï¼‰
- å…¨å±€çŠ¶æ€åŒæ­¥
- éŸ³é‡è®¾ç½®æŒä¹…åŒ–

âœ… **æ’­æ”¾è¿›åº¦è®°å¿†**
- åˆ‡æ¢åˆ°åå°è‡ªåŠ¨ä¿å­˜æ’­æ”¾ä½ç½®
- å›åˆ°å‰å°ä»ä¿å­˜ä½ç½®ç»§ç»­æ’­æ”¾
- æ”¯æŒé•¿æ—¶é—´åå°åæ¢å¤

âœ… **ç”¨æˆ·ä½“éªŒä¼˜åŒ–**
- ç›¸åŒéŸ³ä¹ä¸é‡æ–°æ’­æ”¾
- ä¸åŒéŸ³ä¹å¹³æ»‘åˆ‡æ¢
- æ‰€æœ‰è¿”å›æŒ‰é’®è¿”å›ä¸Šä¸€çº§é¡µé¢

---

## éœ€æ±‚åˆ†æ

### ç”¨æˆ·éœ€æ±‚

1. **èƒŒæ™¯éŸ³ä¹æ’­æ”¾**
   - å…¥å£é¡µé¢ã€ä¸»é¢˜é€‰æ‹©é¡µé¢ã€è§’è‰²é€‰æ‹©é¡µé¢ä½¿ç”¨"ä¸»é¢˜èƒŒæ™¯éŸ³ä¹"
   - é€‰æ‹©è§’è‰²ï¼ˆè±ç‰¹/è–‡è–‡å®‰/é‚¦å¸ƒï¼‰åï¼Œå›¾ç‰‡é€‰æ‹©å’Œæ¸¸æˆé¡µé¢ä½¿ç”¨å¯¹åº”è§’è‰²éŸ³ä¹
   - é€‰æ‹©"ç½‘ç»œéšæœº"æˆ–"ç›¸å†Œä¸Šä¼ "åä½¿ç”¨"ç½‘ç»œä¸ç›¸å†Œ"éŸ³ä¹

2. **å£°éŸ³æ§åˆ¶æŒ‰é’®**
   - ä»¿ç…§è¿”å›æŒ‰é’®æ ·å¼
   - æ”¾ç½®åœ¨æ‰€æœ‰é¡µé¢å³ä¸Šè§’
   - æ˜¾ç¤ºå£°éŸ³/é™éŸ³å›¾æ ‡
   - æ‰€æœ‰é¡µé¢çŠ¶æ€åŒæ­¥

3. **æ’­æ”¾ä½“éªŒ**
   - åˆ‡æ¢åˆ°åå°éŸ³ä¹æš‚åœ
   - å›åˆ°å‰å°ä»æš‚åœä½ç½®ç»§ç»­æ’­æ”¾
   - é¡µé¢åˆ‡æ¢æ—¶ç›¸åŒéŸ³ä¹ä¸ä¸­æ–­

### éŸ³ä¹æ–‡ä»¶æ˜ å°„

| éŸ³ä¹æ–‡ä»¶ | ä½¿ç”¨åœºæ™¯ |
|---------|---------|
| `ä¸»é¢˜èƒŒæ™¯éŸ³ä¹.mp3` | EntryPage, ThemeSelectionPage, CharacterSelectionPage |
| `è±ç‰¹.mp3` | é€‰æ‹©è±ç‰¹åçš„ ImageSelectionPage å’Œ GamePage |
| `è–‡è–‡å®‰.mp3` | é€‰æ‹©è–‡è–‡å®‰åçš„ ImageSelectionPage å’Œ GamePage |
| `é‚¦å¸ƒ.mp3` | é€‰æ‹©é‚¦å¸ƒä¸“è¾‘åçš„ ImageSelectionPage å’Œ GamePage |
| `ç½‘ç»œä¸ç›¸å†Œ.mp3` | é€‰æ‹©ç½‘ç»œéšæœºæˆ–ç›¸å†Œä¸Šä¼ åçš„ ImageSelectionPage å’Œ GamePage |

---

## æŠ€æœ¯æ–¹æ¡ˆ

### æ¶æ„è®¾è®¡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        UI å±‚ï¼ˆæ‰€æœ‰é¡µé¢ï¼‰                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚EntryPage â”‚  â”‚ThemePage â”‚  â”‚ImagePage â”‚  â”‚GamePage  â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜    â”‚
â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  AudioManagerï¼ˆå•ä¾‹ï¼‰                        â”‚
â”‚  â€¢ playBGM()           - æ’­æ”¾èƒŒæ™¯éŸ³ä¹                        â”‚
â”‚  â€¢ resumeBGM()         - æ¢å¤æ’­æ”¾                           â”‚
â”‚  â€¢ savePlaybackPosition() - ä¿å­˜æ’­æ”¾ä½ç½®                    â”‚
â”‚  â€¢ setBGMVolume()      - è®¾ç½®éŸ³é‡                           â”‚
â”‚  â€¢ toggleMute()        - åˆ‡æ¢é™éŸ³                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    HarmonyOS API å±‚                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚
â”‚  â”‚AVPlayer  â”‚  â”‚Preferencesâ”‚ â”‚AppStorageâ”‚                 â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ ¸å¿ƒç»„ä»¶

#### 1. AudioManagerï¼ˆéŸ³é¢‘ç®¡ç†å™¨ï¼‰

**èŒè´£**ï¼š
- ç®¡ç† AVPlayer å®ä¾‹
- æ§åˆ¶éŸ³ä¹æ’­æ”¾ã€æš‚åœã€åˆ‡æ¢
- ç®¡ç†éŸ³é‡å’Œé™éŸ³çŠ¶æ€
- ä¿å­˜å’Œæ¢å¤æ’­æ”¾è¿›åº¦

**å…³é”®å±æ€§**ï¼š
```typescript
private bgmPlayer: media.AVPlayer | null = null;      // BGMæ’­æ”¾å™¨
private bgmVolume: number = 0.5;                      // BGMéŸ³é‡
private currentBGMPath: string = '';                  // å½“å‰éŸ³ä¹è·¯å¾„
private pendingSeekPosition: number = 0;              // å¾…è·³è½¬ä½ç½®
private preferencesStore: preferences.Preferences | null = null;
```

#### 2. SoundButtonï¼ˆå£°éŸ³æ§åˆ¶æŒ‰é’®ç»„ä»¶ï¼‰

**èŒè´£**ï¼š
- æ˜¾ç¤ºå£°éŸ³/é™éŸ³å›¾æ ‡
- åˆ‡æ¢é™éŸ³çŠ¶æ€
- å…¨å±€çŠ¶æ€åŒæ­¥

**å…³é”®ç‰¹æ€§**ï¼š
```typescript
@StorageLink('isSoundMuted') isMuted: boolean = false;  // å…¨å±€çŠ¶æ€åŒæ­¥
```

### æŠ€æœ¯è¦ç‚¹

#### AVPlayer çŠ¶æ€æœº

```
idle (ç©ºé—²)
  â†“ è®¾ç½® fdSrc
initialized (å·²åˆå§‹åŒ–)
  â†“ è°ƒç”¨ prepare()
prepared (å‡†å¤‡å®Œæˆ)
  â†“ è°ƒç”¨ play()
playing (æ’­æ”¾ä¸­)
```

**å…³é”®è§„åˆ™**ï¼š
1. å¿…é¡»åœ¨ `initialized` çŠ¶æ€è°ƒç”¨ `prepare()`
2. å¿…é¡»åœ¨ `prepared` çŠ¶æ€è°ƒç”¨ `play()` å’Œè®¾ç½® `loop`
3. ä½¿ç”¨äº‹ä»¶é©±åŠ¨ï¼Œä¸èƒ½åŒæ­¥è°ƒç”¨

#### æ•°æ®æŒä¹…åŒ–

**åŒé‡ä¿å­˜ç­–ç•¥**ï¼š
- **AppStorage**ï¼šå†…å­˜å­˜å‚¨ï¼Œå¿«é€Ÿè®¿é—®ï¼Œåº”ç”¨å†…æœ‰æ•ˆ
- **Preferences**ï¼šç£ç›˜å­˜å‚¨ï¼ŒæŒä¹…åŒ–ä¿å­˜ï¼Œåº”ç”¨é‡å¯åä»æœ‰æ•ˆ

**ä¿å­˜å†…å®¹**ï¼š
- éŸ³é‡è®¾ç½®ï¼š`bgm_volume`
- å½“å‰éŸ³ä¹è·¯å¾„ï¼š`currentMusicPath`
- æ’­æ”¾ä½ç½®ï¼š`musicPlaybackPosition`

---

## å®æ–½æ­¥éª¤

### æ­¥éª¤1: åˆ›å»º AudioManager

**æ–‡ä»¶**: `entry/src/main/ets/utils/AudioManager.ets`

**æ ¸å¿ƒæ–¹æ³•**ï¼š

1. **playBGM(resourcePath: string)**
   - æ£€æŸ¥è·¯å¾„å»é‡ï¼ˆç›¸åŒéŸ³ä¹ä¸é‡æ–°æ’­æ”¾ï¼‰
   - åœæ­¢å¹¶é‡Šæ”¾æ—§æ’­æ”¾å™¨
   - åˆ›å»ºæ–°æ’­æ”¾å™¨
   - è®¾ç½®éŸ³é‡å’Œå¾ªç¯
   - åŠ è½½éŸ³é¢‘èµ„æº

2. **resumeBGM()**
   - æ£€æŸ¥æ’­æ”¾å™¨çŠ¶æ€
   - å¦‚æœå·²åœ¨æ’­æ”¾ç›¸åŒéŸ³ä¹ï¼Œè·³è¿‡
   - å¦‚æœæ’­æ”¾å™¨å·²åœæ­¢ï¼Œé‡æ–°æ’­æ”¾
   - æ¢å¤æ’­æ”¾ä½ç½®

3. **savePlaybackPosition()**
   - è·å– `currentTime`
   - ä¿å­˜åˆ° AppStorage å’Œ Preferences

4. **restorePlaybackPosition()**
   - è¯»å–ä¿å­˜çš„ä½ç½®
   - ä½¿ç”¨ `seek()` è·³è½¬
   - æ¸…é™¤ä¿å­˜çš„ä½ç½®

### æ­¥éª¤2: åˆ›å»º SoundButton ç»„ä»¶

**æ–‡ä»¶**: `entry/src/main/ets/components/SoundButton.ets`

**ç‰¹æ€§**ï¼š
- ä½¿ç”¨ `@StorageLink` åŒæ­¥å…¨å±€çŠ¶æ€
- æ”¯æŒä¸åŒå±å¹•å°ºå¯¸çš„æŒ‰é’®å¤§å°
- ç‚¹å‡»è°ƒç”¨ `audioManager.toggleMute()`

### æ­¥éª¤3: åœ¨ EntryAbility ä¸­åˆå§‹åŒ–

**ä¿®æ”¹**: `entry/src/main/ets/entryability/EntryAbility.ets`

**å…³é”®ä»£ç **ï¼š
```typescript
// onCreate ä¸­åˆå§‹åŒ–
audioManager.setContext(this.context);

// onForeground ä¸­æ¢å¤æ’­æ”¾
audioManager.resumeBGM();

// onBackground ä¸­ä¿å­˜è¿›åº¦
audioManager.savePlaybackPosition();
```

### æ­¥éª¤4: åœ¨æ‰€æœ‰é¡µé¢é›†æˆéŸ³ä¹å’ŒæŒ‰é’®

**ä¿®æ”¹çš„é¡µé¢**ï¼š
- EntryPage
- ThemeSelectionPage
- CharacterSelectionPage
- ImageSelectionPage
- GamePage

**æ¯ä¸ªé¡µé¢çš„ä¿®æ”¹**ï¼š

1. **å¯¼å…¥ä¾èµ–**
```typescript
import { audioManager } from '../utils/AudioManager';
import { SoundButton } from '../components/SoundButton';
```

2. **åœ¨ aboutToAppear ä¸­æ’­æ”¾éŸ³ä¹**
```typescript
audioManager.playBGM('music/ä¸»é¢˜èƒŒæ™¯éŸ³ä¹.mp3');
```

3. **åœ¨ onPageShow ä¸­æ¢å¤éŸ³ä¹**
```typescript
onPageShow() {
  audioManager.resumeBGM();
}
```

4. **åœ¨ä¸‰ç§å¸ƒå±€ä¸­æ·»åŠ å£°éŸ³æŒ‰é’®**
```typescript
SoundButton({ buttonSize: 60, iconSize: 32 })
  .position({ x: 1020, y: 26 })
```

### æ­¥éª¤5: è·¯ç”±å‚æ•°ä¼ é€’ä¼˜åŒ–

**ImageSelectionPage â†’ GamePage**ï¼š

åœ¨ `startGame()` æ–¹æ³•ä¸­ä¼ é€’ `source` å’Œ `characterId`ï¼š
```typescript
router.pushUrl({
  url: 'pages/GamePage',
  params: {
    // ... å…¶ä»–å‚æ•°
    source: this.source,
    characterId: this.characterId
  }
});
```

---

## é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ

### é—®é¢˜1: è±ç‰¹å’Œè–‡è–‡å®‰çš„éŸ³ä¹ä¸ä¼šåˆ‡æ¢

**é—®é¢˜æè¿°**ï¼š
é€‰æ‹©è±ç‰¹æˆ–è–‡è–‡å®‰åï¼Œè¿›å…¥å›¾ç‰‡é€‰æ‹©é¡µé¢å’Œæ¸¸æˆé¡µé¢ï¼ŒéŸ³ä¹æ²¡æœ‰åˆ‡æ¢ã€‚

**æ ¹æœ¬åŸå› **ï¼š
- `characterId` ä¼ é€’çš„æ˜¯è‹±æ–‡ idï¼ˆ`'laite'`ã€`'weiweian'`ï¼‰
- ä½†éŸ³ä¹æ’­æ”¾é€»è¾‘ä¸­æ¯”è¾ƒçš„æ˜¯ä¸­æ–‡åç§°ï¼ˆ`'è±ç‰¹'`ã€`'è–‡è–‡å®‰'`ï¼‰

**è§£å†³æ–¹æ¡ˆ**ï¼š
```typescript
// ä¿®æ”¹å‰ï¼ˆé”™è¯¯ï¼‰
if (this.characterId === 'è±ç‰¹') {
  musicPath = 'music/è±ç‰¹.mp3';
}

// ä¿®æ”¹åï¼ˆæ­£ç¡®ï¼‰
if (this.characterId === 'laite') {
  musicPath = 'music/è±ç‰¹.mp3';
}
```

**ä¿®æ”¹æ–‡ä»¶**ï¼š
- `ImageSelectionPage.ets` (ç¬¬159-162è¡Œ)
- `GamePage.ets` (ç¬¬269-272è¡Œ)

---

### é—®é¢˜2: è¿”å›æŒ‰é’®è·³è½¬åˆ°é”™è¯¯é¡µé¢

**é—®é¢˜æè¿°**ï¼š
æ¸¸æˆé¡µé¢çš„è¿”å›æŒ‰é’®ç›´æ¥è·³è½¬åˆ°ä¸»é¢˜é€‰æ‹©é¡µé¢ï¼Œè€Œä¸æ˜¯è¿”å›ä¸Šä¸€çº§ï¼ˆå›¾ç‰‡é€‰æ‹©é¡µé¢ï¼‰ã€‚

**æ ¹æœ¬åŸå› **ï¼š
```typescript
// é”™è¯¯å®ç°
private goBackHome(): void {
  router.replaceUrl({
    url: 'pages/ThemeSelectionPage'  // ç¡¬ç¼–ç è·³è½¬
  });
}
```

**è§£å†³æ–¹æ¡ˆ**ï¼š
```typescript
// æ­£ç¡®å®ç°
private goBackHome(): void {
  router.back();  // è¿”å›ä¸Šä¸€çº§
}
```

**å½±å“èŒƒå›´**ï¼š
- æ‰€æœ‰é¡µé¢çš„è¿”å›æŒ‰é’®éƒ½å·²ä½¿ç”¨ `router.back()`
- ç¡®ä¿æ­£ç¡®çš„å¯¼èˆªæ ˆè¡Œä¸º

---

### é—®é¢˜3: åº”ç”¨å›åˆ°å‰å°æ—¶éŸ³ä¹æ— æ³•æ’­æ”¾

**é—®é¢˜æè¿°**ï¼š
ä»åº”ç”¨åˆ‡æ¢åˆ°ä¸»å±ï¼Œå†å›åˆ°åº”ç”¨æ—¶ï¼ŒéŸ³ä¹åœæ­¢ä¸”ä¸ä¼šæ¢å¤æ’­æ”¾ã€‚

**æ ¹æœ¬åŸå› **ï¼š
- åº”ç”¨è¿›å…¥åå°æ—¶ï¼ŒAVPlayer è‡ªåŠ¨æš‚åœ
- å›åˆ°å‰å°æ—¶æ²¡æœ‰è°ƒç”¨æ¢å¤æ’­æ”¾çš„é€»è¾‘

**è§£å†³æ–¹æ¡ˆ**ï¼š

1. **åœ¨ EntryAbility ä¸­æ·»åŠ æ¢å¤é€»è¾‘**
```typescript
onForeground(): void {
  audioManager.resumeBGM();
}
```

2. **åœ¨æ‰€æœ‰é¡µé¢æ·»åŠ  onPageShow**
```typescript
onPageShow() {
  audioManager.resumeBGM();
}
```

3. **AudioManager ä¸­å®ç° resumeBGM**
```typescript
async resumeBGM(): Promise<void> {
  const savedMusicPath = AppStorage.get<string>('currentMusicPath');
  if (savedMusicPath) {
    await this.playBGM(savedMusicPath);
  }
}
```

---

### é—®é¢˜4: é¡µé¢åˆ‡æ¢æ—¶éŸ³ä¹é‡å¤æ’­æ”¾

**é—®é¢˜æè¿°**ï¼š
æ¯æ¬¡åˆ‡æ¢é¡µé¢ï¼Œå³ä½¿æ˜¯ç›¸åŒçš„éŸ³ä¹ä¹Ÿä¼šé‡æ–°å¼€å§‹æ’­æ”¾ã€‚

**æ ¹æœ¬åŸå› **ï¼š
`resumeBGM()` æ–¹æ³•å¼ºåˆ¶æ¸…é™¤äº† `currentBGMPath`ï¼Œå¯¼è‡´è·¯å¾„å»é‡æ£€æŸ¥å¤±æ•ˆã€‚

**è§£å†³æ–¹æ¡ˆ**ï¼š

æ”¹è¿› `resumeBGM()` çš„é€»è¾‘ï¼Œåªåœ¨çœŸæ­£éœ€è¦æ—¶æ‰é‡æ–°æ’­æ”¾ï¼š

```typescript
async resumeBGM(): Promise<void> {
  const savedMusicPath = AppStorage.get<string>('currentMusicPath');
  
  if (this.bgmPlayer) {
    const state = this.bgmPlayer.state;
    
    // âœ… å¦‚æœå·²ç»åœ¨æ’­æ”¾ç›¸åŒçš„éŸ³ä¹ï¼Œè·³è¿‡
    if (state === 'playing' && this.currentBGMPath === savedMusicPath) {
      return;
    }
    
    // âœ… åªåœ¨æ’­æ”¾å™¨çœŸçš„åœæ­¢æ—¶æ‰æ¢å¤æ’­æ”¾
    if ((state === 'stopped' || state === 'paused') && 
        this.currentBGMPath === savedMusicPath) {
      this.currentBGMPath = '';
      await this.playBGM(savedMusicPath);
      return;
    }
  }
  
  // âœ… è·¯å¾„ä¸åŒæ—¶ï¼Œæ­£å¸¸è°ƒç”¨ playBGMï¼ˆä¼šèµ°è·¯å¾„å»é‡æ£€æŸ¥ï¼‰
  await this.playBGM(savedMusicPath);
}
```

---

### é—®é¢˜5: æ’­æ”¾è¿›åº¦è®°å¿†åŠŸèƒ½éœ€æ±‚

**ç”¨æˆ·éœ€æ±‚**ï¼š
å¸Œæœ›ä»åº”ç”¨åˆ‡æ¢åˆ°åå°å†å›æ¥æ—¶ï¼ŒéŸ³ä¹èƒ½ä»æš‚åœçš„ä½ç½®ç»§ç»­æ’­æ”¾ï¼Œè€Œä¸æ˜¯ä»å¤´å¼€å§‹ã€‚

**å®ç°æ–¹æ¡ˆ**ï¼š

1. **ä¿å­˜æ’­æ”¾ä½ç½®**ï¼ˆåº”ç”¨è¿›å…¥åå°æ—¶ï¼‰
```typescript
savePlaybackPosition(): void {
  if (this.bgmPlayer && this.bgmPlayer.state === 'playing') {
    const currentTime = this.bgmPlayer.currentTime;
    
    // ä¿å­˜åˆ° AppStorageï¼ˆå¿«é€Ÿè®¿é—®ï¼‰
    AppStorage.setOrCreate('musicPlaybackPosition', currentTime);
    
    // ä¿å­˜åˆ° Preferencesï¼ˆæŒä¹…åŒ–ï¼‰
    if (this.preferencesStore) {
      this.preferencesStore.put('music_position', currentTime);
      this.preferencesStore.flush();
    }
  }
}
```

2. **æ¢å¤æ’­æ”¾ä½ç½®**ï¼ˆåº”ç”¨å›åˆ°å‰å°æ—¶ï¼‰
```typescript
private async restorePlaybackPosition(): Promise<void> {
  let savedPosition = AppStorage.get<number>('musicPlaybackPosition');
  
  if (!savedPosition && this.preferencesStore) {
    savedPosition = await this.preferencesStore.get('music_position', 0) as number;
  }
  
  if (savedPosition && savedPosition > 0 && this.bgmPlayer) {
    if (this.bgmPlayer.state === 'playing') {
      this.bgmPlayer.seek(savedPosition);  // ç«‹å³è·³è½¬
    } else {
      this.pendingSeekPosition = savedPosition;  // ç­‰å¾… playing çŠ¶æ€
    }
    
    // æ¸…é™¤ä¿å­˜çš„ä½ç½®
    AppStorage.setOrCreate('musicPlaybackPosition', 0);
  }
}
```

3. **åœ¨ playing çŠ¶æ€å¤„ç†å¾…è·³è½¬ä½ç½®**
```typescript
if (state === 'playing') {
  this.currentBGMPath = resourcePath;
  
  // å¦‚æœæœ‰å¾…è·³è½¬çš„ä½ç½®ï¼Œæ‰§è¡Œè·³è½¬
  if (this.pendingSeekPosition > 0 && this.bgmPlayer) {
    this.bgmPlayer.seek(this.pendingSeekPosition);
    this.pendingSeekPosition = 0;
  }
}
```

**å·¥ä½œæµç¨‹**ï¼š
```
æ’­æ”¾åˆ° 2åˆ†15ç§’ â†’ åˆ‡æ¢åˆ°åå° â†’ savePlaybackPosition()
    â†“
ä¿å­˜ä½ç½® 135000ms
    â†“
å›åˆ°å‰å° â†’ resumeBGM() â†’ restorePlaybackPosition()
    â†“
seek(135000) â†’ ä» 2åˆ†15ç§’ç»§ç»­æ’­æ”¾ âœ…
```

---

## æ ¸å¿ƒä»£ç 

### AudioManager å®Œæ•´ç»“æ„

```typescript
export class AudioManager {
  private static instance: AudioManager;
  
  private bgmPlayer: media.AVPlayer | null = null;
  private bgmVolume: number = 0.5;
  private currentBGMPath: string = '';
  private context?: common.UIAbilityContext;
  private preferencesStore: preferences.Preferences | null = null;
  private pendingSeekPosition: number = 0;
  
  static getInstance(): AudioManager { /* ... */ }
  
  async setContext(context: common.UIAbilityContext): Promise<void> { /* ... */ }
  
  async playBGM(resourcePath: string): Promise<void> {
    // ä¿å­˜å½“å‰éŸ³ä¹è·¯å¾„
    AppStorage.setOrCreate('currentMusicPath', resourcePath);
    
    // è·¯å¾„å»é‡æ£€æŸ¥
    if (this.currentBGMPath === resourcePath && 
        this.bgmPlayer?.state === 'playing') {
      return;
    }
    
    // åˆ›å»ºæ’­æ”¾å™¨å¹¶æ’­æ”¾
    // ...
  }
  
  async resumeBGM(): Promise<void> {
    // æ™ºèƒ½æ¢å¤æ’­æ”¾
    // ...
    await this.restorePlaybackPosition();
  }
  
  savePlaybackPosition(): void {
    // ä¿å­˜å½“å‰æ’­æ”¾ä½ç½®
    // ...
  }
  
  private async restorePlaybackPosition(): Promise<void> {
    // æ¢å¤æ’­æ”¾ä½ç½®
    // ...
  }
  
  setBGMVolume(volume: number): void { /* ... */ }
  toggleMute(): void { /* ... */ }
  isMuted(): boolean { /* ... */ }
}

export const audioManager = AudioManager.getInstance();
```

### SoundButton ç»„ä»¶

```typescript
@Component
export struct SoundButton {
  @StorageLink('isSoundMuted') isMuted: boolean = false;
  buttonSize: number = 60;
  iconSize: number = 32;
  
  build() {
    Button() {
      Image(this.isMuted ? 
        $rawfile('images/icon/é™éŸ³.png') : 
        $rawfile('images/icon/å£°éŸ³.png'))
        .width(this.iconSize)
        .height(this.iconSize)
    }
    .width(this.buttonSize)
    .height(this.buttonSize)
    .backgroundColor('rgba(255, 255, 255, 0.9)')
    .borderRadius(this.buttonSize / 2)
    .onClick(() => {
      audioManager.toggleMute();
      this.isMuted = audioManager.isMuted();
    })
  }
}
```

### é¡µé¢é›†æˆç¤ºä¾‹

```typescript
// EntryPage.ets
import { audioManager } from '../utils/AudioManager';
import { SoundButton } from '../components/SoundButton';

@Entry
@Component
struct EntryPage {
  aboutToAppear() {
    // æ’­æ”¾ä¸»é¢˜èƒŒæ™¯éŸ³ä¹
    audioManager.playBGM('music/ä¸»é¢˜èƒŒæ™¯éŸ³ä¹.mp3');
  }
  
  onPageShow() {
    // ç¡®ä¿éŸ³ä¹æ’­æ”¾
    audioManager.resumeBGM();
  }
  
  build() {
    Stack() {
      // èƒŒæ™¯å’Œå…¶ä»–å†…å®¹
      // ...
      
      // å£°éŸ³æ§åˆ¶æŒ‰é’®ï¼ˆå³ä¸Šè§’ï¼‰
      SoundButton({ buttonSize: 60, iconSize: 32 })
        .position({ x: 1020, y: 26 })
    }
  }
}
```

### ImageSelectionPage éŸ³ä¹é€‰æ‹©é€»è¾‘

```typescript
private playBackgroundMusic(): void {
  let musicPath = '';
  
  if (this.source === 'network' || this.source === 'gallery') {
    musicPath = 'music/ç½‘ç»œä¸ç›¸å†Œ.mp3';
  } else if (this.source === 'bangbu') {
    musicPath = 'music/é‚¦å¸ƒ.mp3';
  } else if (this.source === 'character') {
    if (this.characterId === 'laite') {
      musicPath = 'music/è±ç‰¹.mp3';
    } else if (this.characterId === 'weiweian') {
      musicPath = 'music/è–‡è–‡å®‰.mp3';
    }
  }
  
  if (musicPath) {
    audioManager.playBGM(musicPath);
  }
}
```

---

## æµ‹è¯•æŒ‡å—

### åŠŸèƒ½æµ‹è¯•æ¸…å•

#### 1. èƒŒæ™¯éŸ³ä¹æ’­æ”¾æµ‹è¯•

- [x] âœ… EntryPage å¯åŠ¨æ—¶æ’­æ”¾ä¸»é¢˜éŸ³ä¹
- [x] âœ… ThemeSelectionPage ç»§ç»­æ’­æ”¾ä¸»é¢˜éŸ³ä¹ï¼ˆä¸ä¸­æ–­ï¼‰
- [x] âœ… CharacterSelectionPage ç»§ç»­æ’­æ”¾ä¸»é¢˜éŸ³ä¹ï¼ˆä¸ä¸­æ–­ï¼‰
- [x] âœ… é€‰æ‹©è±ç‰¹åæ’­æ”¾è±ç‰¹éŸ³ä¹
- [x] âœ… é€‰æ‹©è–‡è–‡å®‰åæ’­æ”¾è–‡è–‡å®‰éŸ³ä¹
- [x] âœ… é€‰æ‹©é‚¦å¸ƒåæ’­æ”¾é‚¦å¸ƒéŸ³ä¹
- [x] âœ… é€‰æ‹©ç½‘ç»œéšæœºæˆ–ç›¸å†Œä¸Šä¼ åæ’­æ”¾ç½‘ç»œä¸ç›¸å†ŒéŸ³ä¹
- [x] âœ… è¿›å…¥æ¸¸æˆé¡µé¢ç»§ç»­æ’­æ”¾å¯¹åº”éŸ³ä¹ï¼ˆä¸ä¸­æ–­ï¼‰
- [x] âœ… éŸ³ä¹å¾ªç¯æ’­æ”¾

#### 2. å£°éŸ³æ§åˆ¶æµ‹è¯•

- [x] âœ… ç‚¹å‡»å£°éŸ³æŒ‰é’®åˆ‡æ¢é™éŸ³/å¼€å¯çŠ¶æ€
- [x] âœ… æ‰€æœ‰é¡µé¢çš„å£°éŸ³æŒ‰é’®çŠ¶æ€åŒæ­¥
- [x] âœ… é™éŸ³ååˆ‡æ¢é¡µé¢ä¿æŒé™éŸ³
- [x] âœ… å£°éŸ³æŒ‰é’®åœ¨æ‰€æœ‰é¡µé¢çš„å³ä¸Šè§’æ­£ç¡®æ˜¾ç¤º
- [x] âœ… ä¸‰ç§å±å¹•çŠ¶æ€ä¸‹æŒ‰é’®ä½ç½®æ­£ç¡®

#### 3. åº”ç”¨ç”Ÿå‘½å‘¨æœŸæµ‹è¯•

- [x] âœ… æŒ‰ Home é”®åˆ‡æ¢åˆ°ä¸»å±ï¼ŒéŸ³ä¹æš‚åœ
- [x] âœ… é‡æ–°æ‰“å¼€åº”ç”¨ï¼ŒéŸ³ä¹æ¢å¤æ’­æ”¾
- [x] âœ… åˆ‡æ¢åˆ°å…¶ä»–åº”ç”¨ï¼Œå†å›æ¥éŸ³ä¹æ¢å¤
- [x] âœ… é”å±åè§£é”ï¼ŒéŸ³ä¹æ¢å¤
- [x] âœ… ä»é€šçŸ¥æ æ‰“å¼€åº”ç”¨ï¼ŒéŸ³ä¹æ¢å¤

#### 4. æ’­æ”¾è¿›åº¦è®°å¿†æµ‹è¯•

- [x] âœ… æ’­æ”¾åˆ° 30 ç§’ï¼Œåˆ‡æ¢åˆ°åå°
- [x] âœ… ç«‹å³å›åˆ°åº”ç”¨ï¼Œä» 30 ç§’ç»§ç»­æ’­æ”¾
- [x] âœ… æ’­æ”¾åˆ° 1 åˆ†é’Ÿï¼Œåˆ‡æ¢åˆ°åå°ç­‰å¾… 5 åˆ†é’Ÿ
- [x] âœ… å›åˆ°åº”ç”¨ï¼Œä» 1 åˆ†é’Ÿç»§ç»­æ’­æ”¾
- [x] âœ… åˆ‡æ¢ä¸åŒéŸ³ä¹åï¼Œæ–°éŸ³ä¹ä»å¤´å¼€å§‹

#### 5. æ•°æ®æŒä¹…åŒ–æµ‹è¯•

- [x] âœ… è®¾ç½®éŸ³é‡ä¸º 0%ï¼ˆé™éŸ³ï¼‰
- [x] âœ… å®Œå…¨å…³é—­åº”ç”¨åé‡å¯
- [x] âœ… éŸ³é‡è®¾ç½®ä¿æŒä¸º 0%ï¼ˆé™éŸ³ï¼‰
- [x] âœ… æ‰€æœ‰é¡µé¢æ˜¾ç¤ºé™éŸ³å›¾æ ‡

#### 6. å¯¼èˆªæµ‹è¯•

- [x] âœ… GamePage ç‚¹å‡»è¿”å›ï¼Œè¿”å›åˆ° ImageSelectionPage
- [x] âœ… ImageSelectionPage ç‚¹å‡»è¿”å›ï¼Œè¿”å›åˆ°ä¸Šä¸€çº§é¡µé¢
- [x] âœ… æ‰€æœ‰é¡µé¢çš„è¿”å›æŒ‰é’®éƒ½è¿”å›ä¸Šä¸€çº§

### æµ‹è¯•åœºæ™¯ç¤ºä¾‹

#### åœºæ™¯1: åŸºæœ¬éŸ³ä¹æ’­æ”¾æµç¨‹

```
1. å¯åŠ¨åº”ç”¨ï¼ˆEntryPageï¼‰
   âœ… æ’­æ”¾"ä¸»é¢˜èƒŒæ™¯éŸ³ä¹.mp3"

2. ç‚¹å‡»"å¼€å§‹æ‹¼å›¾"è¿›å…¥ ThemeSelectionPage
   âœ… éŸ³ä¹ç»§ç»­æ’­æ”¾ï¼ˆä¸ä¸­æ–­ï¼‰

3. ç‚¹å‡»"è§’è‰²ä¸“è¾‘"è¿›å…¥ CharacterSelectionPage
   âœ… éŸ³ä¹ç»§ç»­æ’­æ”¾ï¼ˆä¸ä¸­æ–­ï¼‰

4. é€‰æ‹©"è±ç‰¹"è¿›å…¥ ImageSelectionPage
   âœ… éŸ³ä¹åˆ‡æ¢åˆ°"è±ç‰¹.mp3"

5. é€‰æ‹©å›¾ç‰‡ï¼Œç‚¹å‡»"å¼€å§‹æ¸¸æˆ"è¿›å…¥ GamePage
   âœ… éŸ³ä¹ç»§ç»­æ’­æ”¾"è±ç‰¹.mp3"ï¼ˆä¸ä¸­æ–­ï¼‰
```

#### åœºæ™¯2: å£°éŸ³æ§åˆ¶æµ‹è¯•

```
1. åœ¨ EntryPageï¼Œç‚¹å‡»å³ä¸Šè§’å£°éŸ³æŒ‰é’®
   âœ… å›¾æ ‡å˜ä¸ºé™éŸ³å›¾æ ‡
   âœ… éŸ³ä¹åœæ­¢æ’­æ”¾

2. åˆ‡æ¢åˆ° ThemeSelectionPage
   âœ… å£°éŸ³æŒ‰é’®æ˜¾ç¤ºé™éŸ³å›¾æ ‡
   âœ… éŸ³ä¹ä¿æŒé™éŸ³

3. ç‚¹å‡»å£°éŸ³æŒ‰é’®
   âœ… å›¾æ ‡å˜ä¸ºå£°éŸ³å›¾æ ‡
   âœ… éŸ³ä¹æ¢å¤æ’­æ”¾
```

#### åœºæ™¯3: æ’­æ”¾è¿›åº¦è®°å¿†æµ‹è¯•

```
1. å¯åŠ¨åº”ç”¨ï¼Œæ’­æ”¾éŸ³ä¹
2. ç­‰å¾…éŸ³ä¹æ’­æ”¾åˆ° 1 åˆ† 30 ç§’
3. æŒ‰ Home é”®åˆ‡æ¢åˆ°ä¸»å±
   âœ… éŸ³ä¹æš‚åœ

4. ç­‰å¾… 30 ç§’

5. é‡æ–°æ‰“å¼€åº”ç”¨
   âœ… éŸ³ä¹ä» 1 åˆ† 30 ç§’ç»§ç»­æ’­æ”¾
   âœ… æ— æ˜æ˜¾è·³è·ƒæ„Ÿ
```

### æ€§èƒ½æŒ‡æ ‡

| æŒ‡æ ‡ | ç›®æ ‡å€¼ | å®é™…å€¼ |
|------|--------|--------|
| BGM å¯åŠ¨æ—¶é—´ | < 500ms | âœ… ç¬¦åˆ |
| éŸ³é‡åˆ‡æ¢å“åº” | å®æ—¶ | âœ… å®æ—¶ |
| é¡µé¢åˆ‡æ¢éŸ³ä¹å»¶è¿Ÿ | < 200ms | âœ… ç¬¦åˆ |
| æ’­æ”¾è¿›åº¦æ¢å¤ç²¾åº¦ | æ¯«ç§’çº§ | âœ… æ¯«ç§’çº§ |
| å‰åå°åˆ‡æ¢æ¢å¤æ—¶é—´ | < 1s | âœ… ç¬¦åˆ |

---

## æ€»ç»“

### å®ç°çš„åŠŸèƒ½

âœ… **èƒŒæ™¯éŸ³ä¹ç³»ç»Ÿ**
- 5 ä¸ªéŸ³ä¹æ–‡ä»¶ï¼Œæ ¹æ®é¡µé¢å’Œé€‰æ‹©è‡ªåŠ¨åˆ‡æ¢
- å¾ªç¯æ’­æ”¾ï¼Œæ— ç¼åˆ‡æ¢
- è·¯å¾„å»é‡æ£€æŸ¥ï¼Œç›¸åŒéŸ³ä¹ä¸é‡æ–°æ’­æ”¾

âœ… **å£°éŸ³æ§åˆ¶ç³»ç»Ÿ**
- ç»Ÿä¸€çš„å£°éŸ³å¼€å…³æŒ‰é’®ï¼ˆæ‰€æœ‰é¡µé¢å³ä¸Šè§’ï¼‰
- å…¨å±€çŠ¶æ€åŒæ­¥ï¼Œæ‰€æœ‰é¡µé¢ä¿æŒä¸€è‡´
- éŸ³é‡è®¾ç½®æŒä¹…åŒ–ï¼ˆä½¿ç”¨ Preferencesï¼‰

âœ… **æ’­æ”¾è¿›åº¦è®°å¿†**
- åº”ç”¨è¿›å…¥åå°è‡ªåŠ¨ä¿å­˜æ’­æ”¾ä½ç½®
- å›åˆ°å‰å°ä»ä¿å­˜ä½ç½®ç»§ç»­æ’­æ”¾
- æ”¯æŒé•¿æ—¶é—´åå°ï¼ˆå‡ åˆ†é’Ÿåˆ°å‡ å°æ—¶ï¼‰
- åŒé‡ä¿å­˜ï¼ˆAppStorage + Preferencesï¼‰

âœ… **ç”Ÿå‘½å‘¨æœŸç®¡ç†**
- EntryAbility çš„ onForeground æ¢å¤æ’­æ”¾
- EntryAbility çš„ onBackground ä¿å­˜è¿›åº¦
- æ‰€æœ‰é¡µé¢çš„ onPageShow ç¡®ä¿éŸ³ä¹æ’­æ”¾

âœ… **ç”¨æˆ·ä½“éªŒä¼˜åŒ–**
- ç›¸åŒéŸ³ä¹ä¸ä¸­æ–­
- ä¸åŒéŸ³ä¹å¹³æ»‘åˆ‡æ¢
- æ‰€æœ‰è¿”å›æŒ‰é’®è¿”å›ä¸Šä¸€çº§é¡µé¢
- éŸ³ä¹ä»æš‚åœä½ç½®ç»§ç»­æ’­æ”¾

### æŠ€æœ¯äº®ç‚¹

1. **å•ä¾‹æ¨¡å¼**ï¼šAudioManager ç¡®ä¿å…¨å±€å”¯ä¸€å®ä¾‹
2. **äº‹ä»¶é©±åŠ¨**ï¼šä¸¥æ ¼éµå¾ª AVPlayer çŠ¶æ€æœº
3. **åŒé‡ä¿å­˜**ï¼šAppStorageï¼ˆå¿«é€Ÿï¼‰+ Preferencesï¼ˆæŒä¹…ï¼‰
4. **æ™ºèƒ½æ¢å¤**ï¼šåŒºåˆ†é¡µé¢åˆ‡æ¢å’Œåº”ç”¨åˆ‡æ¢
5. **è·¯å¾„å»é‡**ï¼šé¿å…é‡å¤æ’­æ”¾ç›¸åŒéŸ³ä¹
6. **è¿›åº¦è®°å¿†**ï¼šç²¾ç¡®åˆ°æ¯«ç§’çš„æ’­æ”¾ä½ç½®ä¿å­˜

### æ–‡ä»¶æ¸…å•

**æ–°å¢æ–‡ä»¶**ï¼š
- `entry/src/main/ets/utils/AudioManager.ets` (368 è¡Œ)
- `entry/src/main/ets/components/SoundButton.ets` (36 è¡Œ)

**ä¿®æ”¹æ–‡ä»¶**ï¼š
- `entry/src/main/ets/entryability/EntryAbility.ets`
- `entry/src/main/ets/pages/EntryPage.ets`
- `entry/src/main/ets/pages/ThemeSelectionPage.ets`
- `entry/src/main/ets/pages/CharacterSelectionPage.ets`
- `entry/src/main/ets/pages/ImageSelectionPage.ets`
- `entry/src/main/ets/pages/GamePage.ets`

### ä»£ç ç»Ÿè®¡

- æ–°å¢ä»£ç ï¼šçº¦ 500 è¡Œ
- ä¿®æ”¹ä»£ç ï¼šçº¦ 200 è¡Œ
- æ€»è®¡ï¼šçº¦ 700 è¡Œä»£ç 

### é‡åˆ°çš„æŒ‘æˆ˜å’Œè§£å†³

1. **characterId ç±»å‹ä¸åŒ¹é…**
   - é—®é¢˜ï¼šè‹±æ–‡ id vs ä¸­æ–‡åç§°
   - è§£å†³ï¼šç»Ÿä¸€ä½¿ç”¨è‹±æ–‡ id è¿›è¡Œæ¯”è¾ƒ

2. **è¿”å›æŒ‰é’®å¯¼èˆªé”™è¯¯**
   - é—®é¢˜ï¼šç¡¬ç¼–ç è·³è½¬ç›®æ ‡
   - è§£å†³ï¼šä½¿ç”¨ `router.back()` è¿”å›ä¸Šä¸€çº§

3. **åº”ç”¨åˆ‡æ¢éŸ³ä¹æ— æ³•æ¢å¤**
   - é—®é¢˜ï¼šæœªå¤„ç†ç”Ÿå‘½å‘¨æœŸ
   - è§£å†³ï¼šåœ¨ onForeground å’Œ onPageShow ä¸­æ¢å¤

4. **é¡µé¢åˆ‡æ¢é‡å¤æ’­æ”¾**
   - é—®é¢˜ï¼šè·¯å¾„å»é‡æ£€æŸ¥å¤±æ•ˆ
   - è§£å†³ï¼šæ”¹è¿› resumeBGM é€»è¾‘

5. **æ’­æ”¾è¿›åº¦ä¸¢å¤±**
   - é—®é¢˜ï¼šæœªä¿å­˜æ’­æ”¾ä½ç½®
   - è§£å†³ï¼šå®ç°å®Œæ•´çš„è¿›åº¦ä¿å­˜å’Œæ¢å¤æœºåˆ¶

### åç»­ä¼˜åŒ–å»ºè®®

1. **éŸ³é‡æ›²çº¿ä¼˜åŒ–**
   - ä½¿ç”¨å¯¹æ•°æ›²çº¿ï¼Œæ›´ç¬¦åˆäººè€³æ„ŸçŸ¥
   - å½“å‰æ˜¯çº¿æ€§éŸ³é‡æ§åˆ¶

2. **æ·¡å…¥æ·¡å‡ºæ•ˆæœ**
   - éŸ³ä¹åˆ‡æ¢æ—¶æ·»åŠ éŸ³é‡æ¸å˜
   - æå‡ç”¨æˆ·ä½“éªŒ

3. **éŸ³é¢‘ç„¦ç‚¹ç®¡ç†**
   - å“åº”ç³»ç»ŸéŸ³é¢‘ç„¦ç‚¹å˜åŒ–
   - ä¸å…¶ä»–åº”ç”¨çš„éŸ³é¢‘ååŒ

4. **é”™è¯¯æ¢å¤æœºåˆ¶**
   - æ’­æ”¾å¤±è´¥æ—¶è‡ªåŠ¨é‡è¯•
   - æä¾›é™çº§æ–¹æ¡ˆ

5. **æ€§èƒ½ä¼˜åŒ–**
   - é¢„åŠ è½½éŸ³ä¹èµ„æº
   - å‡å°‘æ’­æ”¾å»¶è¿Ÿ

### å‚è€ƒæ–‡æ¡£

- HarmonyOS AVPlayer API æ–‡æ¡£
- ArkTS çŠ¶æ€ç®¡ç†æ–‡æ¡£
- HarmonyOS Preferences API æ–‡æ¡£
- ã€ŠéŸ³é¢‘ç³»ç»Ÿå¼€å‘ä¸ä¿®å¤æ–‡æ¡£.mdã€‹ï¼ˆæä¾›çš„å‚è€ƒæ–‡æ¡£ï¼‰

---

**æ–‡æ¡£ç¼–å†™**: AI Assistant  
**æœ€åæ›´æ–°**: 2025å¹´11æœˆ8æ—¥  
**ç‰ˆæœ¬**: v1.0  
**çŠ¶æ€**: âœ… å®Œæˆ

---

## é™„å½•

### éŸ³ä¹æ–‡ä»¶ä½ç½®

```
entry/src/main/resources/rawfile/music/
â”œâ”€â”€ ä¸»é¢˜èƒŒæ™¯éŸ³ä¹.mp3
â”œâ”€â”€ ç½‘ç»œä¸ç›¸å†Œ.mp3
â”œâ”€â”€ è±ç‰¹.mp3
â”œâ”€â”€ è–‡è–‡å®‰.mp3
â””â”€â”€ é‚¦å¸ƒ.mp3
```

### å›¾æ ‡æ–‡ä»¶ä½ç½®

```
entry/src/main/resources/rawfile/images/icon/
â”œâ”€â”€ å£°éŸ³.png
â”œâ”€â”€ é™éŸ³.png
â”œâ”€â”€ è¿”å›.png
â””â”€â”€ ä¸»é¢˜.png
```

### å…³é”® API å‚è€ƒ

**AVPlayer**ï¼š
- `createAVPlayer()`: åˆ›å»ºæ’­æ”¾å™¨
- `fdSrc`: è®¾ç½®æ–‡ä»¶æº
- `prepare()`: å‡†å¤‡æ’­æ”¾
- `play()`: å¼€å§‹æ’­æ”¾
- `stop()`: åœæ­¢æ’­æ”¾
- `release()`: é‡Šæ”¾èµ„æº
- `seek(timeMs)`: è·³è½¬åˆ°æŒ‡å®šä½ç½®
- `currentTime`: è·å–å½“å‰æ’­æ”¾ä½ç½®
- `loop`: è®¾ç½®æ˜¯å¦å¾ªç¯
- `setVolume(volume)`: è®¾ç½®éŸ³é‡

**Preferences**ï¼š
- `getPreferences(context, name)`: è·å–å®ä¾‹
- `get(key, defaultValue)`: è¯»å–æ•°æ®
- `put(key, value)`: å†™å…¥æ•°æ®
- `flush()`: æŒä¹…åŒ–ä¿å­˜

**AppStorage**ï¼š
- `setOrCreate(key, value)`: è®¾ç½®æˆ–åˆ›å»º
- `get(key)`: è¯»å–æ•°æ®
- `@StorageLink`: åŒå‘ç»‘å®šè£…é¥°å™¨
- `@StorageProp`: å•å‘ç»‘å®šè£…é¥°å™¨

---

**æ–‡æ¡£ç»“æŸ**

