# 01 项目规划与整改总览

> 汇总自：`ExperimentPlan.md`、`整改实施方案.md`

本文件对项目从「最初实验方案」到「根据官方评审意见进行整改」的全过程进行归纳，便于快速理解项目目标、阶段规划和整改优先级。

---

## 一、项目背景与总体目标

- **项目名称**：Aurora Weather（沉浸式天气预报 APP）
- **平台 / 技术栈**：HarmonyOS + ArkTS + Open‑Meteo / 和风天气 API
- **核心定位**：以「沉浸式视觉体验 + 简洁交互」为卖点，在有限时间内完成课程要求并在展示中有记忆点。

### 1.1 初始实验目标（ExperimentPlan）

- 完成课程硬性功能：多城市天气展示、网络数据获取、数据持久化、刷新机制等。
- 视觉层面优先：通过视频背景、毛玻璃卡片、渐变主题等手段打造沉浸式 UI。
- 控制复杂度：按「必做 / 加强 / 彩蛋」三层拆分需求，防止过度设计导致延期。
- 并行工作流：一条专注视觉与交互，一条专注功能和数据，避免因后端未就绪拖慢整体。

### 1.2 官方评审后的整改目标（整改实施方案）

- **防御式编程**：关键路径增加异常捕获与恢复机制，避免单点故障导致崩溃。
- **性能量化**：建立 FPS、内存、冷启动时间等可测指标，并纳入验收标准。
- **兼容性兜底**：为视频背景、毛玻璃、复杂动画等提供多级降级策略。
- **数据完整性**：补齐 RDB 版本迁移、数据校验、损坏恢复逻辑。
- **工程成熟度**：在保持学生项目可实现性的前提下，向生产级质量靠拢。

---

## 二、阶段划分与执行路线

### 2.1 功能线（Track F）

- 天气 API 集成与容错：重试、超时、错误分类、离线兜底。
- 数据库存储：城市与天气缓存的 RDB 设计、版本迁移与备份策略。
- 定位与权限：自动定位当前城市、权限弹窗与使用场景说明。
- 缓存策略：按天气类型动态设置有效期，极端天气缩短缓存时间。

### 2.2 视觉线（Track V）

- 背景系统三层兜底：视频 → 动图（WebP） → 渐变背景。
- 毛玻璃卡片与统一设计语言：透明度、阴影、圆角与分层规范。
- 轻量动画点缀：适量 Lottie / WebP 动效，兼顾观感与性能。
- 性能压测：在不同设备 / 模拟器组合下测试滑动、刷新、动效压力。

### 2.3 四周节奏（来自整改实施方案）

- **第 1 周**：搭建工程架构与核心页面雏形；完成背景系统初版与 Mock 数据驱动。
- **第 2 周**：补齐城市管理、网络层容错、缓存和部分调试工具。
- **第 3 周**：强化性能与防御式编程，补齐数据库迁移与监控工具。
- **第 4 周**：集中修复问题、整理文档、准备答辩与演示脚本。

---

## 三、官方评审要点与风险项

### 3.1 性能与兼容性

- 视频背景在低端设备 / 模拟器上存在掉帧、黑屏风险。
- 多层 `backdropBlur` 重叠可能导致 GPU 压力过大。
- 建议通过设备能力检测（RAM、分辨率、GPU）选择不同渲染模式。

### 3.2 数据层风险

- 缺少数据库版本管理与迁移策略，升级时可能导致崩溃。
- 缓存有效期单一，无法适应雷暴等需要高频更新的场景。
- 建议引入 `schema_metadata`、`version + onUpgrade` 等机制。

### 3.3 代码质量与异步处理

- 提示加强类型安全，避免 `any/unknown` 与未约束对象字面量。
- 网络层需增加超时、取消、重试与错误分级策略。
- 建议对关键异步调用路径补充运行时监控与日志。

---

## 四、整改优先级矩阵（摘要）

- **P0（立即修复）**
  - 解决编译阻塞与崩溃级问题（视频兼容、数据库异常等）。
  - 确保应用能稳定启动、核心流程可用。
- **P1（高优先级）**
  - 性能瓶颈优化与缓存策略升级。
  - 完善城市管理、定位、主题切换等核心体验。
- **P2 / P3（中低优先级）**
  - 非关键动效与彩蛋功能。
  - 可选调试工具与拓展性改造。

---

## 五、量化验收与立即行动清单

### 5.1 验收指标（示例）

- 冷启动时间、列表滑动 FPS、视频播放流畅度达到预期阈值。
- 编译零错误，关键路径无未捕获异常。
- 核心功能（多城市、定位、缓存、主题切换）在主流设备上稳定运行。

### 5.2 立即执行动作（精简版）

- 完成背景系统三层兜底与设备能力检测。
- 为 RDB 与缓存引入版本 / 校验 / 恢复方案。
- 按官方建议逐项核对权限声明、异常处理与网络鲁棒性。

> 本文可作为阅读项目的起点：先了解整体规划与整改方向，再结合后续各专题文档（功能、视觉、修复、规范等）深入具体细节。

